<?php

/**
 * POTP print view
 *
 * @author Gyula Szabo, MTA SZTAKI
 * @package simpleSAMLphp
 * @version $Id$
 */

// Get config object
$globalConfig = SimpleSAML_Configuration::getInstance();
$authority = 'ldapandyubi';

$as = new SimpleSAML_Auth_Simple($authority);
$as->requireAuth();
$attributes = $as->getAttributes();
$uid = $attributes['uid'][0];

//$ldapandyubi = $as->getAuthSource();
$ldapandyubi = SimpleSAML_Auth_Source::getById($authority);


$t = new SimpleSAML_XHTML_Template($globalConfig, 'ldapandyubi:potpprint.php');
$t->data['potps'] = $ldapandyubi->getPOTPs($uid);
$t->show();
exit();

?>
